(()=>{const s=document.getElementById('sidebar'),h=document.getElementById('hamburger'),l=[...document.querySelectorAll('.nav-item')],c=document.getElementById('content'),S={blitzer:document.getElementById('view-blitzer'),report:document.getElementById('view-report'),admin:document.getElementById('view-admin')};function a(e){l.forEach(t=>t.setAttribute('aria-current',t.dataset.route===e?'true':'false'))}function o(e){Object.values(S).forEach(t=>t.hidden=!0),(S[e]||S.blitzer).hidden=!1,a(e),window.innerWidth<=1024&&s.classList.remove('open'),e==='blitzer'&&i(),e==='report'&&r()}function d(){const e=(location.hash||'#blitzer').slice(1);return['blitzer','report','admin'].includes(e)?e:'blitzer'}l.forEach(e=>e.addEventListener('click',t=>{t.preventDefault(),history.pushState(null,'','#'+e.dataset.route),o(e.dataset.route)})),window.addEventListener('hashchange',()=>o(d()),{passive:!0}),h.addEventListener('click',()=>s.classList.toggle('open'));let n,m,u;async function i(){if(!n){n=L.map('map-blitzer',{zoomControl:!0,touchZoom:!0,scrollWheelZoom:!1,doubleClickZoom:!0,dragging:!0,boxZoom:!1}),L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19,attribution:'© OpenStreetMap'}).addTo(n),n.setView([51.1657,10.4515],6),setTimeout(()=>n.invalidateSize(),0)}else setTimeout(()=>n.invalidateSize(),0)}function r(){if(!m){m=L.map('map-report',{zoomControl:!0,touchZoom:!0,scrollWheelZoom:!1,doubleClickZoom:!0,dragging:!0,boxZoom:!1}),L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19,attribution:'© OpenStreetMap'}).addTo(m),m.setView([51.1657,10.4515],6),m.on('click',e=>{u?u.setLatLng(e.latlng):u=L.marker(e.latlng,{draggable:!0}).addTo(m),document.getElementById('btn-submit-report').disabled=!1}),setTimeout(()=>m.invalidateSize(),0)}else setTimeout(()=>m.invalidateSize(),0)}['gesturestart','gesturechange','gestureend'].forEach(e=>{document.addEventListener(e,t=>t.preventDefault())}),document.addEventListener('wheel',e=>{e.ctrlKey&&e.preventDefault()},{passive:!1}),document.getElementById('btn-submit-report')?.addEventListener('click',async()=>{if(!u)return;const e=u.getLatLng(),t=e.lat,l=e.lng;alert()}),document.getElementById('btn-admin-login')?.addEventListener('click',()=>{const e=document.getElementById('admin-code').value.trim();alert('Admin-Code gesendet: '+(e?'***':'(leer)'))}),o(d())})();
